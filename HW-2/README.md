## Лабораторная работа - Развертывание коммутируемой сети с резервными каналами

### 1. Создание сети и настройка основных параметров устройства

#### 1.1 Топология сети:

![alt-текст](https://github.com/Galo9/HW_Network_engineer/blob/main/HW-2/HW2_topology.PNG)

#### 1.2 Настройка основных параметров коммутаторов

```
    Switch>enable   // Переход в привелигированный режим EXEC
    Switch#config t   // Переход в режим настройки
    Switch(config)#no ip domain lookup   // Отключаем поиск по DNS
    Switch(config)#hostname S1   // Назначаем имя коммутатору
    S1(config)#enable secret class   // Назначаем class в качестве пароля для привилегированного режима EXEC с шифрованием
    S1(config)#service password-encryption   // Шифруем пароли в конфигурации
    S1(config)#line console 0   // Назначаем пароль для консоли
    S1(config-line)#password cisco
    S1(config-line)#login  // Включаем вход в систему
    S1(config-line)#logging synchronous   //Запрещаем вывод консольных сообщений, которые могут прервать ввод команд в консольном режиме
    S1(config-line)#exit
    S1(config)#line vty 0 4   // Назначаем пароль для VTY
    S1(config-line)#password cisco
    S1(config-line)#login   // Включаем вход в систему
    S1(config-line)#exit
    S1(config)#no service password-encryption
    S1(config)#banner login $Unauthorized access is prohibited!$   // Создаем баннер о том, что несанкционированный доступ запрещен
    
    S1(config)#interface vlan 1   // Задаём IP-адрес для VLAN 1
    S1(config-if)#ip address 192.168.1.1 255.255.255.0   // Для коммутатора S2 IP-адрес - 192.168.1.2, для коммуторора S3 - 192.168.1.3
    S1(config-if)#no shutdown   // Включаем порт
    S1(config-if)#exit
    S1(config)#exit
    S1#copy run sta   // Копируем текущую конфигурацию в файл загрузочной конфигурации
```
#### 1.3 Проверка связи

Успешно ли выполняется эхо-запрос от коммутатора S1 на коммутатор S2?

Успешно ли выполняется эхо-запрос от коммутатора S1 на коммутатор S3?

Успешно ли выполняется эхо-запрос от коммутатора S2 на коммутатор S3?

Ответ: Да

![alt-текст](https://github.com/Galo9/HW_Network_engineer/blob/main/HW-2/HW2_ping.PNG)


### 2. Определение корневого моста

#### 1.1 Отключение всех портов на коммутаторах.

```
    S1(config)#interface e0/0
    S1(config-if)#shutdown   // Выключаем порт e0/0
    S1(config-if)#exit
    S1(config)#interface e0/1
    S1(config-if)#shutdown   // Выключаем порт e0/1
    S1(config-if)#exit
    S1(config)#interface e0/2
    S1(config-if)#shutdown   // Выключаем порт e0/2
    S1(config-if)#exit
    S1(config)#interface e0/3
    S1(config-if)#shutdown   // Выключаем порт e0/3
    S1(config-if)#exit  
```
Аналогично отключаются порты на коммутаторах S2 и S3.

#### 1.2 Настройка подключенных портов в качестве транковых.

```
    S1(config)#interface e0/0
    S1(config-if)#switchport trunk encapsulation dot1q   // Делаем процедуру инкапсуляции статической для настройки статического trunk 
    S1(config-if)#switchport mode trunk   // Переводим интерфейс в режим статического trunk
```
Аналогично порты E0/0, E0/1, E0/2 и E0/3 настраиваются в начестве транковых на коммутаторах S2 и S3.

#### 1.3 Включение портов e0/2 и e0/0 на всех коммутаторах.

```
    S1(config)#interface e0/0
    S1(config-if)#no shutdown   // Включаем порт e0/0
    S1(config-if)#exit  
    S1(config)#interface e0/2
    S1(config-if)#no shutdown   // Включаем порт e0/2
```
Аналогично включаются порты E0/2 и E0/0 на коммутаторах S2 и S3.

#### 1.4 Отображение данных протокола spanning-tree.

![alt-текст](https://github.com/Galo9/HW_Network_engineer/blob/main/HW-2/HW2_spanning-tree.PNG)

Вопросы: 

1) Какой коммутатор является корневым мостом?

Ответ: Корневым мостом стал коммутатор S1.

2) Почему этот коммутатор был выбран протоколом spanning-tree в качестве корневого моста?

Ответ: Идентификатор Bridge ID (BID) состоит из значения приоритета моста, значения расширенного идентификатора системы и MAC-адреса коммутатора. Так как у всех коммутаторов равны значения приоритета и расширенного идентификатора системы (VLAN), корневым мостом становися коммутатор S1, потому что у него с наименьшее значение MAC-адреса.

3) Какие порты на коммутаторе являются корневыми портами? 

Ответ: На коммутаторе S2 - e0/2, на коммутаторе S3 - e0/0.

4) Какие порты на коммутаторе являются назначенными портами? 

Ответ: На коммутаторе S1 - e0/0 и e0/2, на коммутаторе S2 - e0/0.

5) Какой порт отображается в качестве альтернативного и в настоящее время заблокирован?

Ответ: На коммутаторе S3 - e0/2.

6) Почему протокол spanning-tree выбрал этот порт в качестве невыделенного (заблокированного) порта?

Ответ: После выбора корневого моста протокол spanning-tree просчитывает кратчайший путь к корневому мосту, соответствующие порты становятся корневыми портами. Далее просчитывается кратчайший путь к корневому порту. На основании наименьшей стоимости корневого пути, наименьшего BID определяются назначенные порты. Затем все порты, которые не являются ни корневыми, ни назначенными становятся альтернативными (заблокированными) портами. В данном случае у коммутатора S3 наибольший BID (так как наибольшее значение MAC-адреса), порт e0/0 становится корневым, соответственно e0/2 становится альтернативным.


### 3. Наблюдение за процессом выбора протоколом STP порта, исходя из стоимости портов

#### 3.1 Определение коммутатора с заблокированным портом

```
    S3#show spanning-tree
```
На коммутаторе S3 порт e0/2 заблокирован.

#### 3.2 Изменение стоимости порта

```
    S3(config)#interface e0/0
    S3(config-if)#spanning-tree cost 18   // Меняем стоимость порта e0/0 коммутатора S3 с 100 на 18
```

#### 3.3 Просмотр изменений протокола spanning-tree

![alt-текст](https://github.com/Galo9/HW_Network_engineer/blob/main/HW-2/HW2_spanning-tree_2.PNG)

Вопрос: 

Почему протокол spanning-tree заменяет ранее заблокированный порт на назначенный порт и блокирует порт, который был назначенным портом на другом коммутаторе?

Ответ: Потому что стоимость порта e0/0 коммутатора S3 стала ниже, он становится назначенным портом, соответственно, исходя из логики, описанной ранее в п. 1.4,  порт e0/0 коммутатора S2 блокируется.


#### 3.4 Удаление изменения стоимости порта

```
    S3(config)# interface e0/0
    S3(config-if)# no spanning-tree cost 18   // Возвращаем стоимость порта e0/0 коммутатора S3
```

### 4. Наблюдение за процессом выбора протоколом STP порта, исходя из приоритета портов

```
    S1(config)#interface e0/1
    S1(config-if)#no shutdown   // Включаем порт e0/1
    S1(config-if)#exit  
    S1(config)#interface e0/3
    S1(config-if)#no shutdown   // Включаем порт e0/3
```
Аналогично включаются порты E0/1 и E0/3 на коммутаторах S2 и S3.

![alt-текст](https://github.com/Galo9/HW_Network_engineer/blob/main/HW-2/HW2_spanning-tree_3.PNG)

Вопросы:

1) Какой порт выбран протоколом STP в качестве порта корневого моста на каждом коммутаторе некорневого моста? 

Ответ: На коммутиторе S2 - порт e0/1.
На коммутаторе S3 - порт e0/0.

2) Почему протокол STP выбрал эти порты в качестве портов корневого моста на этих коммутаторах?

Ответ: Так как стоимость портов равна, BID - тоже, то выбираются порты с наименьшим значением приоритета.

3) Какое значение протокол STP использует первым после выбора корневого моста, чтобы определить выбор порта?

Ответ: Стоимость порта. 

4) Если первое значение на двух портах одинаково, какое следующее значение будет использовать протокол STP при выборе порта?

Ответ: При одинаковой стоимости порта - BID.

5) Если оба значения на двух портах равны, каким будет следующее значение, которое использует протокол STP при выборе порта?

Ответ: MAC-адрес.